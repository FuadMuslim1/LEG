import{c as T,r as x,j as e,m as Ge,q as Y,i as g,f as u,w as ae,v as F,x as Ve,p as re,e as b,B as Se,s as w,T as Qe,t as We,n as Ze}from"./index-C5MxSQsq.js";import{A as Je,U as ke,T as Xe}from"./AdminLayout-ySf5CHEQ.js";import{a as et,S as tt,F as st}from"./Skeleton-BX0QDTub.js";import{F as Re,D as at,C as rt,u as le,w as lt}from"./xlsx-DV0spwX2.js";import{C as q}from"./circle-check-big-D2dOgAAE.js";import{A as nt}from"./arrow-right-jm2l9Inu.js";import{G as it}from"./log-out-DAX5-8ca.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],dt=T("medal",ot);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],xt=T("pen-line",ct);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],Ce=T("percent",ut);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],pt=T("tag",mt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],bt=T("trophy",ht);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ne=T("zap",ft),gt=({isOpen:G,title:m,message:V,onConfirm:P,onCancel:N,isProcessing:f,confirmLabel:k="Ya, Proses",isDestructive:d=!1})=>G?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/50 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsx("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-2xl overflow-hidden border border-slate-100 animate-in zoom-in-95 duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 text-slate-800",children:[e.jsx("div",{className:`p-2 rounded-full ${d?"bg-red-100 text-red-600":"bg-amber-100 text-amber-600"}`,children:e.jsx(Qe,{size:20})}),e.jsx("h3",{className:"font-bold text-lg",children:m})]}),e.jsx("p",{className:"text-slate-600 text-sm whitespace-pre-wrap leading-relaxed mb-6 pl-1",children:V}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:N,disabled:f,className:"px-4 py-2 rounded-lg text-slate-600 hover:bg-slate-100 font-bold text-xs transition-colors",children:"Batal"}),e.jsxs("button",{onClick:P,disabled:f,className:`px-4 py-2 rounded-lg text-white font-bold text-xs transition-colors flex items-center gap-2 shadow-md 
                ${d?"bg-red-600 hover:bg-red-700 shadow-red-200":"bg-indigo-600 hover:bg-indigo-700 shadow-indigo-200"}`,children:[f&&e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),k]})]})]})})}):null,Et=({user:G})=>{var ge,je,we,Ne,ye,ve,Ae;const[m,V]=x.useState("INCOMING"),[P,N]=x.useState(!1),[f,k]=x.useState(null),[d,B]=x.useState(!1),[U,_]=x.useState(""),[Q,H]=x.useState(!1),[z,Ee]=x.useState(1e5),[ie,Te]=x.useState("100000"),[I,oe]=x.useState(!0),[j,W]=x.useState([]),[Z,J]=x.useState([]),[R,M]=x.useState([]),C=Z.filter(t=>t.type==="CASHBACK"),E=Z.filter(t=>t.type==="REFERRAL_BONUS"),[c,O]=x.useState({email:"",title:"",amount:"",description:""}),[X,Pe]=x.useState(""),[de,jt]=x.useState(1),ce=10,[n,h]=x.useState({isOpen:!1,type:null,data:null}),[ee,xe]=x.useState({show:!1,message:"",type:"success"}),p=(t,s="success")=>{xe({show:!0,message:t,type:s}),setTimeout(()=>xe(a=>({...a,show:!1})),4e3)},te=async()=>{N(!0);try{const t=Y(g(u,"registrations"),ae("status","==","VERIFIED")),a=(await F(t)).docs.map(o=>({id:o.id,...o.data()})).filter(o=>!o.rewardStatus||o.rewardStatus==="PENDING").sort((o,K)=>{var A,D;return(((A=o.createdAt)==null?void 0:A.seconds)||0)-(((D=K.createdAt)==null?void 0:D.seconds)||0)}),l=Y(g(u,"reward_calculations"),Ve("createdAt","desc")),i=(await F(l)).docs.map(o=>({id:o.id,...o.data()})),y=i.filter(o=>o.status==="READY_TO_SEND"),v=i.filter(o=>o.status==="SENT");W(a),J(y),M(v)}catch(t){console.error("Fetch data error:",t),p("Gagal mengambil data.","error")}finally{N(!1)}};x.useEffect(()=>{te()},[m]);const _e=()=>{const t=parseInt(ie.replace(/\D/g,""));if(!t||t<=0)return p("Nominal tidak valid.","error");Ee(t),oe(!0),p(`Harga dikunci: Rp ${t.toLocaleString()}`,"success")},ue=async t=>{const s=re(u);if(t.usedReferralCode&&t.usedReferralCode!=="-"){const v=g(u,"users"),o=Y(v,ae("referralCode","==",t.usedReferralCode)),K=await F(o);if(!K.empty){const A=K.docs[0],D=A.data(),Ke=Y(v,ae("referredBy","==",t.usedReferralCode)),se=(await F(Ke)).size;let S="Rookie",$=.05;if(se>30?(S="Legend",$=.1):se>10&&(S="Pro",$=.07),D.level!==S){s.update(A.ref,{level:S});const qe=b(g(u,"user_notifications"));s.set(qe,{userEmail:A.id,title:"Level Up!",message:`Selamat! Level Anda naik menjadi ${S}. Nikmati bonus referral lebih besar (${$*100}%).`,isRead:!1,createdAt:w(),type:"SYSTEM",link:"/dashboard"})}const Ye=z*$,Fe=b(g(u,"reward_calculations"));s.set(Fe,{sourceId:t.id,type:"REFERRAL_BONUS",targetEmail:A.id,targetName:D.fullName||"Unknown",tier:S,referralCount:se,percentage:$,transactionBase:z,bonusAmount:Ye,status:"READY_TO_SEND",createdAt:w(),description:`Referral Bonus (Tier ${S}) dari: ${t.fullName}`})}}const a=b(u,"users",t.email),l=await Ze(a);let r=0,i="";if(!l.exists())r=.05,i="Welcome Cashback (5%) - New Member";else{const o=l.data().level||"Rookie";(o==="Pro"||o==="Legend")&&(r=.05,i=`Loyalty Cashback (5%) - ${o} Renewal`)}if(r>0){const v=z*r,o=b(g(u,"reward_calculations"));s.set(o,{sourceId:t.id,type:"CASHBACK",targetEmail:t.email,targetName:t.fullName,transactionBase:z,percentage:r,bonusAmount:v,status:"READY_TO_SEND",createdAt:w(),description:i})}const y=b(u,"registrations",t.id);return s.update(y,{rewardStatus:"CALCULATED"}),await s.commit(),t.id},me=async t=>{const s=re(u),a=b(u,"users",t.targetEmail);s.update(a,{balance:Se(t.bonusAmount)});const l=b(u,"reward_calculations",t.id);s.update(l,{status:"SENT",sentAt:w()});const r=b(g(u,"user_notifications"));return s.set(r,{userEmail:t.targetEmail,title:t.type==="CASHBACK"?"Cashback Diterima!":"Referral Reward Masuk!",message:`Saldo +${t.bonusAmount.toLocaleString()}. (${t.description})`,isRead:!1,createdAt:w(),type:"REWARD",link:"/dashboard"}),await s.commit(),t.id},Oe=t=>h({isOpen:!0,type:"ENTER_POIN",data:t}),pe=t=>h({isOpen:!0,type:"PAYOUT",data:t}),Le=async()=>{const t=n.data;if(t){k(t.id);try{await ue(t),W(s=>s.filter(a=>a.id!==t.id)),te(),h({isOpen:!1,type:null,data:null}),p("Sukses menghitung reward!","success")}catch(s){p("Gagal: "+s.message,"error")}finally{k(null)}}},De=async()=>{const t=n.data;if(t){k(t.id);try{await me(t),J(s=>s.filter(a=>a.id!==t.id)),M(s=>[{...t,status:"SENT"},...s]),h({isOpen:!1,type:null,data:null}),p("Payout terkirim!","success")}catch(s){p("Gagal payout: "+s.message,"error")}finally{k(null)}}},$e=()=>h({isOpen:!0,type:"BULK_CALC",data:j}),he=()=>{let t=[];m==="PAYOUT_CASHBACK"?t=C:m==="PAYOUT_REFERRAL"&&(t=E),h({isOpen:!0,type:"BULK_PAYOUT",data:t})},Be=async()=>{const t=n.type,s=n.data;if(!s||s.length===0)return;B(!0),h({...n,isOpen:!1});let a=0;const l=s.length;try{if(t==="BULK_CALC"){for(const r of s){_(`Calculating ${a+1}/${l}: ${r.fullName}`);try{await ue(r),a++,W(i=>i.filter(y=>y.id!==r.id))}catch(i){console.error(`Failed to process ${r.id}`,i)}}p(`Selesai! Berhasil menghitung ${a} reward.`,"success"),te()}else if(t==="BULK_PAYOUT"){for(const r of s){_(`Sending ${a+1}/${l}: Rp ${r.bonusAmount.toLocaleString()}`);try{await me(r),a++,J(i=>i.filter(y=>y.id!==r.id)),M(i=>[{...r,status:"SENT"},...i])}catch(i){console.error(`Failed to pay ${r.id}`,i)}}p(`Selesai! Berhasil mengirim ${a} pembayaran.`,"success")}}catch(r){p("Bulk Process Error: "+r.message,"error")}finally{B(!1),_(""),h({isOpen:!1,type:null,data:null})}},be=t=>{if(!t)return"-";const s=t.seconds?new Date(t.seconds*1e3):new Date(t);return new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"2-digit",hour:"2-digit",minute:"2-digit"}).format(s)},Ue=()=>{const t=`Date,User Name,User Email,Type,Bonus Amount,Description,Status
`,s=R.map(i=>`"${be(i.sentAt||i.createdAt)}","${i.targetName}","${i.targetEmail}","${i.type}","${i.bonusAmount}","${i.description}","${i.status}"`).join(`
`),a=new Blob([t+s],{type:"text/csv"}),l=window.URL.createObjectURL(a),r=document.createElement("a");r.href=l,r.download=`REWARD_HISTORY_${new Date().toISOString().split("T")[0]}.csv`,r.click(),H(!1)},He=()=>{const t=R.map(l=>({Date:be(l.sentAt||l.createdAt),User:l.targetName,Email:l.targetEmail,Type:l.type,Amount:l.bonusAmount,Description:l.description,Status:l.status})),s=le.json_to_sheet(t),a=le.book_new();le.book_append_sheet(a,s,"Transactions"),lt(a,`REWARD_HISTORY_${new Date().toISOString().split("T")[0]}.xlsx`),H(!1)},ze=()=>h({isOpen:!0,type:"RESET_HISTORY",data:R}),Ie=async()=>{const t=n.data;if(!t||t.length===0)return;B(!0),h({...n,isOpen:!1});let s=0;const a=t.length;try{for(const l of t){_(`Deleting ${s+1}/${a}...`);try{await We(b(u,"reward_calculations",l.id)),s++}catch(r){console.error(`Failed to delete history ${l.id}`,r)}}M([]),p(`Reset Berhasil! ${s} riwayat transaksi dihapus.`,"success")}catch(l){p("Gagal reset data: "+l.message,"error")}finally{B(!1),_(""),h({isOpen:!1,type:null,data:null})}},Me=async t=>{if(t.preventDefault(),!(!c.email||!c.amount)){N(!0);try{const s=c.email.toLowerCase(),a=re(u),l=b(u,"users",s);a.update(l,{balance:Se(Number(c.amount))});const r=b(g(u,"reward_calculations"));a.set(r,{type:"ACHIEVEMENT",targetEmail:s,targetName:"Manual Event",bonusAmount:Number(c.amount),title:c.title,description:c.description,status:"SENT",sentAt:w(),createdAt:w()});const i=b(g(u,"user_notifications"));a.set(i,{userEmail:s,title:`Event Reward: ${c.title}`,message:`+${c.amount} Poin! ${c.description}`,isRead:!1,createdAt:w(),type:"ACHIEVEMENT"}),await a.commit(),p("Event Reward sent!","success"),O({email:"",title:"",amount:"",description:""}),N(!1)}catch(s){p("Gagal: "+s.message,"error"),N(!1)}}},fe=R.filter(t=>{if(!X)return!0;const s=X.toLowerCase();return(t.targetName||"").toLowerCase().includes(s)||(t.targetEmail||"").toLowerCase().includes(s)}).slice((de-1)*ce,de*ce),L=({id:t,label:s,icon:a,count:l,colorClass:r})=>e.jsxs("button",{onClick:()=>V(t),className:`flex-1 min-w-[140px] py-4 px-2 text-xs md:text-sm font-bold border-b-2 flex flex-col md:flex-row items-center justify-center gap-2 transition-all
        ${m===t?"border-indigo-600 text-indigo-600 bg-indigo-50/50":"border-transparent text-slate-500 hover:bg-slate-50 hover:text-slate-700"}
      `,children:[e.jsxs("div",{className:`relative ${m===t?"text-indigo-600":"text-slate-400"}`,children:[e.jsx(a,{size:18}),l>0&&e.jsx("span",{className:`absolute -top-2 -right-2 ${r} text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full shadow-sm`,children:l})]}),e.jsx("span",{children:s})]});return e.jsxs(Je,{user:G,title:"Reward Center",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-slate-500 font-bold uppercase",children:"Base Price"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"text",value:ie,onChange:t=>Te(t.target.value),disabled:I,className:`w-full text-sm font-bold font-mono outline-none ${I?"bg-transparent":"border-b border-indigo-300"}`}),e.jsx("button",{onClick:()=>I?oe(!1):_e(),className:"text-indigo-500 hover:text-indigo-700",children:I?e.jsx(xt,{size:14}):e.jsx(q,{size:14})})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-slate-500 font-bold uppercase",children:"To Process"}),e.jsx("div",{className:"text-lg font-bold text-slate-800",children:j.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-slate-500 font-bold uppercase",children:"Pending Payout"}),e.jsx("div",{className:"text-lg font-bold text-amber-600",children:Z.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-slate-500 font-bold uppercase",children:"Paid Out"}),e.jsxs("div",{className:"text-lg font-bold text-emerald-600",children:["Rp ",R.reduce((t,s)=>t+(s.bonusAmount||0),0).toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-white rounded-t-xl border-b border-slate-200 flex flex-wrap shadow-sm sticky top-[70px] z-20",children:[e.jsx(L,{id:"INCOMING",label:"New Registrations",icon:Ge,count:j.length,colorClass:"bg-blue-500"}),e.jsx(L,{id:"PAYOUT_CASHBACK",label:"Cashback Payouts",icon:Ce,count:C.length,colorClass:"bg-emerald-500"}),e.jsx(L,{id:"PAYOUT_REFERRAL",label:"Referral Bonuses",icon:ke,count:E.length,colorClass:"bg-purple-500"}),e.jsx(L,{id:"HISTORY",label:"History",icon:Re,count:0,colorClass:""}),e.jsx(L,{id:"MANUAL",label:"Manual",icon:dt,count:0,colorClass:""})]}),e.jsxs("div",{className:"bg-white p-6 rounded-b-xl border border-slate-200 border-t-0 min-h-[500px]",children:[m==="INCOMING"&&e.jsxs("div",{className:"animate-in fade-in space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 mb-4 p-3 bg-blue-50 text-blue-700 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(pt,{size:16}),e.jsxs("p",{children:["User ",e.jsx("strong",{children:"Verified"}),'. Klik "Hitung" untuk memproses reward.']})]}),j.length>0&&e.jsxs("button",{onClick:$e,disabled:d,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-xs font-bold flex items-center gap-2 shadow-md shadow-blue-200 transition-all w-full md:w-auto justify-center",children:[d?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(ne,{size:14}),"Hitung Semua (",j.length,")"]})]}),d&&m==="INCOMING"&&e.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-xl flex items-center justify-between shadow-lg animate-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"font-bold text-sm",children:"Processing Bulk Action..."})]}),e.jsx("span",{className:"text-xs font-mono bg-slate-700 px-2 py-1 rounded",children:U})]}),P&&j.length===0?e.jsx(et,{className:"h-20 w-full"}):j.length===0?e.jsx("div",{className:"text-center py-12 text-slate-400 border-2 border-dashed border-slate-100 rounded-xl",children:"Tidak ada registrasi baru."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(t=>e.jsxs("div",{className:"border border-slate-200 p-4 rounded-xl hover:border-blue-400 transition-all shadow-sm group bg-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-800",children:t.fullName}),e.jsx("div",{className:"text-xs text-slate-500",children:t.email})]}),e.jsxs("span",{className:"bg-slate-100 text-slate-600 text-[10px] font-bold px-2 py-1 rounded",children:["Ref: ",t.usedReferralCode]})]}),e.jsx("button",{onClick:()=>Oe(t),disabled:!!f||d,className:"w-full py-2 bg-blue-600 text-white rounded-lg text-xs font-bold flex items-center justify-center gap-2 group-hover:bg-blue-700 disabled:opacity-50",children:f===t.id?"Calculating...":e.jsxs(e.Fragment,{children:[e.jsx(nt,{size:14})," Hitung Reward"]})})]},t.id))})]}),m==="PAYOUT_CASHBACK"&&e.jsxs("div",{className:"animate-in fade-in space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 mb-4 p-3 bg-emerald-50 text-emerald-800 rounded-lg border border-emerald-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ce,{size:16}),e.jsxs("p",{children:["Antrian ",e.jsx("strong",{children:"Cashback"}),' (Member Baru/Renew). Klik "Kirim Saldo" untuk transfer.']})]}),C.length>0&&e.jsxs("button",{onClick:he,disabled:d,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-xs font-bold flex items-center gap-2 shadow-md shadow-emerald-200 transition-all w-full md:w-auto justify-center",children:[d?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(ne,{size:14}),"Kirim Semua (",C.length,")"]})]}),d&&m==="PAYOUT_CASHBACK"&&e.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-xl flex items-center justify-between shadow-lg animate-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"font-bold text-sm",children:"Processing Cashback Payouts..."})]}),e.jsx("span",{className:"text-xs font-mono bg-slate-700 px-2 py-1 rounded",children:U})]}),C.length===0?e.jsx("div",{className:"text-center py-12 text-slate-400 border-2 border-dashed border-slate-100 rounded-xl",children:"Antrian Cashback kosong."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(t=>{var s;return e.jsxs("div",{className:"border border-emerald-200 bg-emerald-50/30 p-4 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-white text-xs bg-emerald-500",children:"CB"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-800 text-sm",children:t.targetName}),e.jsxs("div",{className:"text-xs font-mono font-bold text-emerald-600",children:["+ ",(s=t.bonusAmount)==null?void 0:s.toLocaleString()]})]})]}),e.jsx("p",{className:"text-[10px] text-slate-500 mb-3 line-clamp-2",children:t.description}),e.jsx("button",{onClick:()=>pe(t),disabled:!!f||d,className:"w-full py-2 bg-emerald-700 text-white rounded-lg text-xs font-bold flex items-center justify-center gap-2 hover:bg-emerald-800 disabled:opacity-50 shadow-md shadow-emerald-200/50",children:f===t.id?"Sending...":e.jsxs(e.Fragment,{children:[e.jsx(q,{size:14})," Kirim Saldo"]})})]},t.id)})})]}),m==="PAYOUT_REFERRAL"&&e.jsxs("div",{className:"animate-in fade-in space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 mb-4 p-3 bg-purple-50 text-purple-800 rounded-lg border border-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ke,{size:16}),e.jsxs("p",{children:["Antrian ",e.jsx("strong",{children:"Referral Bonus"}),' (Affiliate). Klik "Kirim Saldo" untuk transfer.']})]}),E.length>0&&e.jsxs("button",{onClick:he,disabled:d,className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-xs font-bold flex items-center gap-2 shadow-md shadow-purple-200 transition-all w-full md:w-auto justify-center",children:[d?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(ne,{size:14}),"Kirim Semua (",E.length,")"]})]}),d&&m==="PAYOUT_REFERRAL"&&e.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-xl flex items-center justify-between shadow-lg animate-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"font-bold text-sm",children:"Processing Referral Bonuses..."})]}),e.jsx("span",{className:"text-xs font-mono bg-slate-700 px-2 py-1 rounded",children:U})]}),E.length===0?e.jsx("div",{className:"text-center py-12 text-slate-400 border-2 border-dashed border-slate-100 rounded-xl",children:"Antrian Referral kosong."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(t=>{var s;return e.jsxs("div",{className:"border border-purple-200 bg-purple-50/30 p-4 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-white text-xs bg-purple-500",children:"REF"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-800 text-sm",children:t.targetName}),e.jsxs("div",{className:"text-xs font-mono font-bold text-purple-600",children:["+ ",(s=t.bonusAmount)==null?void 0:s.toLocaleString()]})]})]}),e.jsx("p",{className:"text-[10px] text-slate-500 mb-3 line-clamp-2",children:t.description}),e.jsx("button",{onClick:()=>pe(t),disabled:!!f||d,className:"w-full py-2 bg-purple-700 text-white rounded-lg text-xs font-bold flex items-center justify-center gap-2 hover:bg-purple-800 disabled:opacity-50 shadow-md shadow-purple-200/50",children:f===t.id?"Sending...":e.jsxs(e.Fragment,{children:[e.jsx(q,{size:14})," Kirim Saldo"]})})]},t.id)})})]}),m==="HISTORY"&&e.jsxs("div",{className:"animate-in fade-in",children:[e.jsxs("div",{className:"flex flex-col xl:flex-row justify-between items-center gap-4 mb-4",children:[e.jsx("h3",{className:"font-bold text-slate-700 text-sm",children:"Transaction History"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full xl:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx(tt,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),e.jsx("input",{type:"text",placeholder:"Cari nama/email...",value:X,onChange:t=>Pe(t.target.value),className:"w-full pl-9 pr-3 py-2 border border-slate-200 rounded-lg text-xs outline-none focus:border-indigo-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 md:flex-none",children:[e.jsxs("button",{onClick:()=>H(!Q),className:"w-full justify-center bg-slate-100 text-slate-700 px-3 py-2 rounded-lg hover:bg-slate-200 text-xs font-bold flex items-center gap-2 transition-colors border border-slate-200",children:[e.jsx(at,{size:14}),e.jsx("span",{children:"Export"}),e.jsx(rt,{size:14,className:`transition-transform duration-200 ${Q?"rotate-180":""}`})]}),Q&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>H(!1)}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 z-20 p-1 animate-in fade-in zoom-in-95 duration-200 overflow-hidden",children:[e.jsxs("button",{onClick:Ue,className:"w-full text-left px-4 py-3 hover:bg-slate-50 rounded-lg text-xs font-bold text-slate-700 flex items-center gap-2 transition-colors",children:[e.jsx(st,{size:16,className:"text-indigo-500"}),e.jsx("span",{children:"Download CSV"})]}),e.jsxs("button",{onClick:He,className:"w-full text-left px-4 py-3 hover:bg-slate-50 rounded-lg text-xs font-bold text-slate-700 flex items-center gap-2 transition-colors",children:[e.jsx(Re,{size:16,className:"text-emerald-500"}),e.jsx("span",{children:"Download Sheet"})]})]})]})]}),e.jsxs("button",{onClick:ze,disabled:d||R.length===0,className:"flex-1 md:flex-none justify-center bg-red-50 text-red-600 px-3 py-2 rounded-lg hover:bg-red-100 border border-red-100 text-xs font-bold flex items-center gap-2 transition-colors disabled:opacity-50",children:[e.jsx(Xe,{size:14})," Reset History"]})]})]})]}),d&&m==="HISTORY"&&e.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-xl flex items-center justify-between shadow-lg animate-in slide-in-from-top-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{className:"font-bold text-sm",children:"Deleting Data..."})]}),e.jsx("span",{className:"text-xs font-mono bg-slate-700 px-2 py-1 rounded",children:U})]}),e.jsx("div",{className:"overflow-x-auto border border-slate-200 rounded-xl",children:e.jsxs("table",{className:"w-full text-left text-xs",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-500 border-b border-slate-200 font-bold uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"User"}),e.jsx("th",{className:"p-3",children:"Type"}),e.jsx("th",{className:"p-3",children:"Amount"}),e.jsx("th",{className:"p-3",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:fe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-4 text-center text-slate-400",children:"Tidak ada data."})}):fe.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-bold text-slate-700",children:t.targetName}),e.jsx("div",{className:"text-slate-400",children:t.targetEmail})]}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"bg-slate-100 px-2 py-1 rounded",children:t.type})}),e.jsx("td",{className:"p-3 font-mono font-bold text-emerald-600",children:(s=t.bonusAmount)==null?void 0:s.toLocaleString()}),e.jsxs("td",{className:"p-3 text-emerald-600 font-bold flex items-center gap-1",children:[e.jsx(q,{size:12})," Sent"]})]},t.id)})})]})})]}),m==="MANUAL"&&e.jsx("div",{className:"max-w-xl mx-auto py-6 animate-in fade-in",children:e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2 mb-6",children:[e.jsx(bt,{size:20,className:"text-amber-500"})," Input Event Reward"]}),e.jsxs("form",{onSubmit:Me,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Email User"}),e.jsx("input",{type:"email",required:!0,value:c.email,onChange:t=>O({...c,email:t.target.value}),className:"w-full p-3 rounded-lg border border-slate-200 bg-slate-50 outline-none text-sm",placeholder:"user@email.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Event Title"}),e.jsx("input",{type:"text",required:!0,value:c.title,onChange:t=>O({...c,title:t.target.value}),className:"w-full p-3 rounded-lg border border-slate-200 bg-slate-50 outline-none text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Amount (Rp)"}),e.jsx("input",{type:"number",required:!0,value:c.amount,onChange:t=>O({...c,amount:t.target.value}),className:"w-full p-3 rounded-lg border border-slate-200 bg-slate-50 outline-none text-sm font-bold"})]})]}),e.jsx("textarea",{value:c.description,onChange:t=>O({...c,description:t.target.value}),className:"w-full p-3 rounded-lg border border-slate-200 bg-slate-50 outline-none text-sm h-24",placeholder:"Deskripsi..."}),e.jsx("button",{disabled:P,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg flex items-center justify-center gap-2",children:P?"Sending...":e.jsxs(e.Fragment,{children:[e.jsx(it,{size:18})," Kirim Reward"]})})]})]})})]}),e.jsx(gt,{isOpen:n.isOpen,title:n.type==="ENTER_POIN"?"Konfirmasi Hitung Reward":n.type==="PAYOUT"?"Konfirmasi Payout":n.type==="BULK_CALC"?"Konfirmasi Hitung Semua":n.type==="BULK_PAYOUT"?m==="PAYOUT_CASHBACK"?"Kirim Semua Cashback":"Kirim Semua Referral":"Konfirmasi Reset History",message:n.type==="ENTER_POIN"?`Hitung reward untuk ${(ge=n.data)==null?void 0:ge.fullName}?`:n.type==="PAYOUT"?`Kirim saldo Rp ${(we=(je=n.data)==null?void 0:je.bonusAmount)==null?void 0:we.toLocaleString()} ke ${(Ne=n.data)==null?void 0:Ne.targetEmail}?`:n.type==="BULK_CALC"?`Anda akan menghitung reward untuk ${(ye=n.data)==null?void 0:ye.length} user secara otomatis. Lanjutkan?`:n.type==="BULK_PAYOUT"?`Anda akan mengirim saldo kepada ${(ve=n.data)==null?void 0:ve.length} user sekaligus. Pastikan data sudah benar. Lanjutkan?`:`PERHATIAN: Anda akan MENGHAPUS SEMUA data riwayat transaksi (${(Ae=n.data)==null?void 0:Ae.length} data) dari database secara PERMANEN. 

Data yang dihapus tidak bisa dikembalikan. Lanjutkan?`,onConfirm:n.type==="ENTER_POIN"?Le:n.type==="PAYOUT"?De:n.type==="RESET_HISTORY"?Ie:Be,onCancel:()=>h({isOpen:!1,type:null,data:null}),confirmLabel:n.type==="ENTER_POIN"?"Hitung Sekarang":n.type==="PAYOUT"?"Kirim Saldo":n.type==="RESET_HISTORY"?"Ya, Hapus Semua":"Proses Semua",isProcessing:!!f||d,isDestructive:n.type==="RESET_HISTORY"}),ee.show&&e.jsx("div",{className:`fixed top-6 right-6 z-[110] p-4 rounded-xl shadow-xl flex items-center gap-3 animate-in slide-in-from-right ${ee.type==="error"?"bg-red-50 text-red-700":"bg-emerald-50 text-emerald-700"}`,children:e.jsx("div",{className:"font-bold text-sm",children:ee.message})})]})};export{Et as AdminReward};
